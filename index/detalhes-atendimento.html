<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalhes do Atendimento - PetHosp</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
    <nav class="navbar navbar-dark bg-primary mb-4">
        <div class="container-fluid">
            <a class="navbar-brand" href="home.html">PetHosp</a>
            <a href="home.html" class="btn btn-outline-light btn-sm">Voltar</a>
        </div>
    </nav>

    <div class="container mt-4">
        <div class="card shadow">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h4 class="mb-0">Detalhes do Atendimento</h4>
                <span id="statusBadge" class="badge bg-secondary">Status</span>
            </div>
            <div class="card-body" id="detalhesContent">
                <p class="text-center text-muted">Carregando...</p>
            </div>
            <div class="card-footer text-end">
                <button onclick="window.print()" class="btn btn-secondary btn-sm">Imprimir</button>
                <a href="home.html" class="btn btn-primary btn-sm">Voltar para Home</a>
            </div>
        </div>
    </div>

    <script src="JS/session-auth.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const params = new URLSearchParams(window.location.search);
            const id = params.get("id");
            const atendimentos = JSON.parse(localStorage.getItem("atendimentos")) || [];
            const atendimento = atendimentos.find(a => a.id === id);

            const container = document.getElementById("detalhesContent");
            const badge = document.getElementById("statusBadge");

            if (!atendimento) {
                container.innerHTML = `<div class="alert alert-danger">Atendimento não encontrado.</div>`;
                return;
            }

            // Configura Badge de Status
            badge.textContent = atendimento.status;
            if(atendimento.status === 'Em Atendimento') badge.className = 'badge bg-warning text-dark';
            else if(atendimento.status === 'Finalizado') badge.className = 'badge bg-success';
            else if(atendimento.status === 'Cancelado') badge.className = 'badge bg-danger';
            else badge.className = 'badge bg-primary';

            container.innerHTML = `
                <div class="row mb-4">
                    <div class="col-md-6">
                        <h6 class="text-muted">Identificação</h6>
                        <p><strong>Nº:</strong> ${atendimento.id}</p>
                        <p><strong>Data/Hora:</strong> ${atendimento.dataHora}</p>
                        <p><strong>Veterinário:</strong> ${atendimento.veterinario || '-'}</p>
                        <p><strong>Prioridade:</strong> <span class="${atendimento.prioridade === 'Emergência' ? 'text-danger fw-bold' : ''}">${atendimento.prioridade}</span></p>
                    </div>
                    <div class="col-md-6">
                        <h6 class="text-muted">Paciente</h6>
                        <p><strong>Tutor:</strong> ${atendimento.tutor}</p>
                        <p><strong>Animal:</strong> ${atendimento.animal} (${atendimento.especie || ''} - ${atendimento.raca || ''})</p>
                        <p><strong>Peso:</strong> ${atendimento.peso || '-'} kg</p>
                    </div>
                </div>
                <hr>
                <div class="row">
                    <div class="col-12 mb-3">
                        <h6 class="text-muted">Triagem</h6>
                        <p><strong>Motivo:</strong> ${atendimento.motivo}</p>
                        <p><strong>Temperatura:</strong> ${atendimento.temperatura}°C</p>
                        <p><strong>Sintomas:</strong> ${atendimento.sintomas || 'Não informado'}</p>
                    </div>
                    <div class="col-12">
                        <h6 class="text-muted">Observações</h6>
                        <div class="p-3 bg-light border rounded">${atendimento.observacoes || 'Nenhuma observação registrada.'}</div>
                    </div>
                </div>
            `;
        });
    </script>
</body>
</html>