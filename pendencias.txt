=================================================
PEND√äNCIAS E STATUS - SISTEMA MULTI-CL√çNICA
=================================================

Este documento descreve o que j√° foi implementado para suportar m√∫ltiplas cl√≠nicas e o que ainda precisa ser feito para garantir que o sistema funcione corretamente nesse modelo.

---------------------------------
‚úÖ O QUE J√Å FOI FEITO
---------------------------------

1.  **Estrutura do Banco de Dados:**
    *   O banco de dados foi preparado com sucesso. Praticamente todas as tabelas (tutores, animais, atendimentos, produtos, etc.) j√° possuem a coluna `clinica_id`.
    *   Isso significa que a base para associar cada registro a uma cl√≠nica espec√≠fica j√° existe.

2.  **Autentica√ß√£o Inteligente (JWT):**
    *   Quando um usu√°rio faz login, o sistema gera um "token" de seguran√ßa (JWT).
    *   Este token agora carrega duas informa√ß√µes cruciais: o `clinica_id` e o `role` (papel, ex: "admin" ou "super-admin") do usu√°rio.

3.  **Isolamento de Dados (Exemplo em Tutores):**
    *   As rotas da API para gerenciar tutores (`/tutores`) j√° foram atualizadas para usar o `clinica_id` do token.
    *   **Na pr√°tica:** Quando um usu√°rio logado pede a lista de tutores, a API filtra e retorna apenas os tutores associados √† sua cl√≠nica. O mesmo acontece ao criar, editar ou deletar um tutor, garantindo que um usu√°rio da "Cl√≠nica A" n√£o possa ver ou modificar dados da "Cl√≠nica B".

---------------------------------
üéØ O QUE PRECISA SER FEITO AGORA
---------------------------------

O padr√£o de isolamento de dados implementado em "Tutores" precisa ser replicado para TODAS as outras partes do sistema.

1.  **Replicar o Padr√£o de `clinica_id` para Todas as Rotas:**
    *   **Onde:** Em todos os arquivos de rotas dentro de `backend/routes/` (ex: `animais_routes.py`, `atendimentos_routes.py`, `produtos_routes.py`, `agendamentos_routes.py`, etc.).
    *   **O que fazer:** Em cada rota (GET, POST, PUT, DELETE), obter o `clinica_id` do token e us√°-lo nas consultas SQL, exatamente como foi feito em `tutores_routes.py`.
        *   Para `INSERT`: Adicionar o `clinica_id` ao criar um novo registro.
        *   Para `SELECT`, `UPDATE`, `DELETE`: Adicionar `WHERE clinica_id = ?` para filtrar os registros.

2.  **Implementar a Vis√£o do "Super-Admin":**
    *   **Onde:** Nas rotas de listagem (GET) de todas as entidades (tutores, animais, etc.).
    *   **O que fazer:** Adicionar uma verifica√ß√£o do `role` do usu√°rio.
        *   Se `role == 'super-admin'`, a consulta SQL **N√ÉO DEVE** ter o filtro `WHERE clinica_id = ?`, para que ele possa ver os dados de todas as cl√≠nicas.
        *   Se o `role` for qualquer outro, o filtro `WHERE clinica_id = ?` √© obrigat√≥rio.

3.  **Restringir Gerenciamento de Cl√≠nicas:**
    *   **Onde:** No arquivo `backend/routes/clinica_routes.py`.
    *   **O que fazer:** Proteger as rotas de cria√ß√£o (`POST`), atualiza√ß√£o (`PUT`) e exclus√£o (`DELETE`) de cl√≠nicas. Apenas usu√°rios com `role == 'super-admin'` devem ter permiss√£o para executar essas a√ß√µes. Isso impede que um administrador normal crie ou apague cl√≠nicas.

4.  **Ajustar Cria√ß√£o de Novos Usu√°rios:**
    *   **Onde:** Na rota de registro de usu√°rios (provavelmente em `auth_routes.py`).
    *   **O que fazer:** A l√≥gica para criar novos usu√°rios precisa ser mais inteligente.
        *   Um `super-admin` deve poder criar um novo usu√°rio e associ√°-lo a qualquer `clinica_id`.
        *   Um `admin` de uma cl√≠nica s√≥ deve poder criar usu√°rios para a sua pr√≥pria cl√≠nica (o `clinica_id` do novo usu√°rio deve ser o mesmo do `admin` que o est√° criando).